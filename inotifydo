#!/bin/bash

# Support the legacy --twice option, now this runs twice by default.
command="$@"
if [ $1 = "-t" ] || [ $1 = "--twice" ]; then
    command=( "${@}" )
    command="${command[*]:1}"
fi

eval "$command"

while true; do
    # Wait for files to be changed starting on this directory
    inotifywait -r -e modify -e move -e create -e delete --exclude="/\." .

    # Evaluate the given command and its arguments (like sudo does)
    eval "$command"
done

